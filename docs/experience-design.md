# 体験設計ガイド

目的リマインダー：本ガイドは「子どもが飽きずに科学的に裏付けられた『できた！』体験を繰り返す」ための演出・UI・難易度設計を標準化する。

## 子ども向けUIの基本原則
- **直感操作**：主要ボタンは72pt以上、四隅へ余白を取り誤タップを防止。指示は最大2文でひらがな中心。
- **配色**：高彩度のアクセント＋落ち着いた背景で主対象を強調。WCAG 2.1 AAのコントラストを維持し、色弱シミュレーションで確認。
- **視線誘導**：重要情報は画面中央〜下部に配置、視線移動を減らし集中を保つ。進捗バーとタイマーは常に同位置。
- **多言語**：ひらがな表示を基本としつつ、英語ラベルを小さく併記できるレイアウトを確保。保護者向けテキストは漢字＋ふりがなを検討。
- **落ち着く演出バランス**：成功演出は華やかでも、失敗時は静かな効果音と優しい色で再挑戦を促し、恐怖学習を避ける。

## ドーパミンを意識した報酬設計
- **即時フィードバック（<0.5秒）**：音（ドミナント和音）、光（ソフトグロー）、肯定ボイスを同時に発火させ、成功と快感の結び付きを強化。
- **変動比率（VR）強化**：3・5・10連続成功で希少演出（虹色パーティクル、特別ボイス）をランダム発火し、予測できないご褒美で期待感を維持。
- **サプライズカタログ**：演出パターンを少なくとも6種保持し、同一セッションで同じ演出が連続しないよう管理。
- **ストーリーテリング**：各ゲームに小さな“冒険”感（例：楽器集め、動物をお手伝い）を持たせ、進捗による解放で長期的モチベーションを支援。
- **エラーレス学習**：ミス後は即ヒント→再挑戦成功で通常報酬より少し控えめな演出にし、成功体験を守りつつ負荷を調整。

## ステージ設計とランダム性の扱い
- **段階的ランダム化**：
  - Lv1：刺激は限定セット（3〜4種類）で一貫性を重視。
  - Lv2：刺激種類を拡張し、提示順序のみランダム化。
  - Lv3：刺激内容（数字・ひらがなパターン）をラウンドごとにランダム抽選。
  - Lv4：二重ランダム化（刺激内容＋ノイズ要素）で抽象度を上げる。
- **制御された多様性**：難易度帯ごとに`seed`を用意し、再挑戦時に完全同一を避けつつ、学習追跡できる程度にバリエーションを限定。
- **カテゴリ別バランシング**：ひらがな／数字／図形などを偏りなく提示するため、カテゴリごとの出現カウンターで重み付けシャッフルを行う。
- **習熟検知**：反応時間が既定閾値より速い状態が連続3回続いたら、ランダム性の幅を一段階拡張し新刺激を導入。
- **セッション多様化**：1セッション内で同じパターンが3回以上出現しないようガードし、飽きを防止。

## 継続率向上のための演出サイクル
1. **小さな目標の提示**：初回は「3回連続成功で星をあつめよう」など短期目標から始め、目標達成で次のチャレンジがアンロックされる。
2. **マイルストーン演出**：5・10・15回成功時にミニバッジや称号を付与し、ハブ画面でコレクション状況を表示する。
3. **小休止リマインド**：15分前後で「お水タイム」アニメーションを出し、保護者向けに進行状況とおすすめ休憩コメントを提示。
4. **セッション総括**：終了時に成功率グラフ、獲得バッジ、保護者向け一言コメントを表示し、次回の小目標を予告して継続意欲を喚起。

## 実装メモ
- 演出アセットは `public/assets/sfx` と `public/assets/animations` に整理し、メタデータ(YAML/JSON)で発火条件を管理。
- ランダム性は `adaptive` モジュールに乱数シード管理クラスを用意し、ミニゲームから一貫して呼び出す。
- 演出強度・音量などは保護者設定で個別調整できるよう`rewards`のコンフィグにフックを持たせる。
- カードやボタンの裏面は記号ではなくシンボリックなアイコン（星やパターン）を用い、どの状態でもワクワクするビジュアルを維持する。

このガイドは `docs/tickets.md` の関連チケット（RWD-02, RTM-01, PMM-01 など）と併せて参照し、開発中も目的との整合を常に確認すること。

- 保護者ゲート (`CaregiverGateModal`) で報酬設定を保護者のみが変更できるようにした。
- 報酬演出の音量／スペシャル演出可否は `useRewardSettingsStore` で制御し、`RewardScheduler` や `RewardToast` に反映する。

## 目標ゴールデザイン指針
- ゲーム開始時は"スター3個"など達成しやすいゴールを提示し、クリアすると次のチャレンジ（例: スター5個＋スピードアップ）を提案する。
- ゴールUIはハブとゲーム画面双方で確認可能にし、進捗バーやアイコンで「あといくつでごほうびか」一目で分かるようにする。
- 連続クリアで得られるバッジは色や形を変化させ、収集を楽しめるメダルブック風のUIにまとめる。
- グローバルスターを集めてマイルストーンを解放し、解放時は全画面オーバーレイで祝福する。
