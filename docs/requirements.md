# 要件定義書

## 目的リマインダー
本プロジェクトの全要件は、「科学に基づいた楽しい『できた！』体験を4〜7歳の子どもに届け、保護者にも安心感を提供する」というゴールに従う。

## 主要ペルソナ
- **好奇心旺盛な子ども（4〜7歳）**：楽しい挑戦、短いフィードバック、着実な上達感を求める。
- **サポートする保護者**：安全で科学的根拠のある活動を望み、進捗が分かりやすいツールを求める。

## 体験ゴール
- 適応難易度によって成功率70〜85%帯を維持し、フロー体験を崩さない。
- 保護者が横で見守り、必要に応じて手助けできるUI/UXを備える。
- 1回のプレイが15分以内で収まり、適切な休憩を促すソフトリマインドを提供する。

## 機能要件（フェーズ1 Web MVP）
### ゲームアクセスとセッションフロー
- FR1: ブラウザから即起動できるキッズ向けハブを用意し、アカウント不要で開始できる。
- FR2: 初回オンボーディングで保護者が報酬演出設定を確認し、子どもの誤操作を防ぐゲートを通過する。
- FR3: 約15分経過で休憩を促すタイマー通知と、再開できる仕組みを備える。

### ゲームモジュール（初期2タイトル）
- FR4: 聴覚パターンを再現するリズムゲーム「Rhythm Tap」を実装し、0.5秒以内にフィードバックする。
- FR5: 視覚記憶を鍛えるカードゲーム「Pair Match」を実装し、格子サイズや記号の複雑さを可変にする。
- FR6: 各ゲームがパターン長・テンポ・グリッドサイズ・シンボル複雑度などの段階的難易度を公開する。
- FR7: 成功ストリークに応じてサウンド・アニメーション・ナレーションを組み合わせた報酬を提供する共通レイヤーを実装する。

### 適応ロジックと進捗管理
- FR8: 成功数、反応時間、ミス回数などの指標をローカルストレージで保持する。
- FR9: 各ラウンド後に難易度を調整し、勝ち続ければ上げ、連続失敗で下げるなどのルールを定義する。
- FR10: 3回連続で失敗した場合は自動ヒント（エラーレス学習）を提示する。
- FR11: 最新セッションの成功率・反応時間推移などを保護者向けダッシュボードで簡潔に表示する。

### コンテンツとUX
- FR12: 高コントラスト、大きなタッチ領域、子どもに親しみやすいビジュアルを提供する。
- FR13: UIの主要テキストを日英両対応し、将来の多言語展開の足がかりを作る。
- FR14: 設定や購入操作は保護者ゲート（簡単な計算や長押し）でロックし、誤操作を防ぐ。
- FR15: ゲーム画面に小さな目標（例: 次のごほうびまで何回）を表⽰し、達成で演出が変化するようにする。
- FR16: 成功演出は音・光・ボイスを組み合わせ、0.5秒以内に発火する。変動比率報酬で希少演出を制御する。
- FR17: 各難易度帯で提示刺激に制御されたランダム性を持たせ、カテゴリ偏りと重複を監視する。

## 非機能要件
- NFR1: タブレットを主軸にレスポンシブ対応し、タッチ操作を優先する。
- NFR2: 中程度のタブレット＋家庭用Wi-Fi環境で、主要アセットを3秒以内に読込完了する。
- NFR3: 初回アクセス後はサービスワーカーでオフライン動作をサポートする。
- NFR4: 進捗データをローカル保存し、将来のクラウド同期に備えたエクスポート／インポート手段を用意する。
- NFR5: WCAG 2.1 AAのコントラスト基準を満たし、成功時に視覚・聴覚の両方でフィードバックする。
- NFR6: 共通コアを改変せずに新規ミニゲームを追加できる拡張性を保つ。
- NFR7: 新規参加メンバーが1週間以内にミニゲームを追加できる程度のドキュメンテーションと開発フローを整える。
- NFR8: 報酬演出と刺激バリエーションのメタデータを管理し、同一セッションで同じ演出が3回以上連続しないよう制御する。

## コンプライアンスと倫理
- MVP段階では個人情報を収集せず、COPPA／GDPR準拠を保つ。
- アプリ内に保護者向けプライバシーポリシーとデータ取り扱いの説明を明示する。
- 将来のクラウド解析を有効化する際は、保護者の明示的な同意を必須とする。

## フェーズ別マイルストーン
- M1: デザインシステム、コアエンジン骨格、2タイトルのプレイアブル実装、適応ロジックの完成。
- M2: オフライン対応ビルドと保護者ダッシュボード試作、PWAテスト実行。
- M3: 解析連携のためのイベントスキーマと同意フローの仕様書を作成（実装は後続）。

## 受け入れ基準のスナップショット
- プレイテストで成功率が70〜85%に収束することを確認できる。
- セッション終了時、保護者ダッシュボードに反応時間の推移が表示される。
- 15分経過時にポジティブな言葉で休憩を促す通知が発火する。
